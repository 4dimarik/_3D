(()=>{"use strict";new class{constructor({deadLine:e="2021-12-27T18:35:00",timerSelector:t,format:i={},doubleZero:s=!0,separator:a=":"}){this.timerSelector=t,this.formatSelectors=i,this.separator=a,this.deadLine=e,this.doubleZero=s,this.init()}init(){this.timer=document.querySelector(this.timerSelector),this.format={},this.timer&&Object.keys(this.formatSelectors).forEach((e=>{let t=e.replace("Selector","");this.format[t]=this.timer.querySelector(this.formatSelectors[e])}))}start(){this.isDateHasCome()?this.render({days:"0",hours:"0",minutes:"0",seconds:"0"}):(this.handle(),this.updateClock=setInterval(this.handle.bind(this),1e3))}stop(){clearInterval(this.updateClock)}render(e){Object.keys(this.format).forEach((t=>{this.format[t].textContent=this.doubleZero?this.getTwoDigitNumber(e[t]):e[t],this.format[t].nextElementSibling.textContent=this.setSeparator(e[t],t)}))}handle(){if(this.isDateHasCome())this.stop();else{let e=new Date(this.deadLine).getTime(),t=(new Date).getTime();const i=this.getTimeRemaining(e,t);this.render(i)}}getTimeRemaining(e,t){let i=(e-t)/1e3;return{days:Math.floor(i/60/60/24),hours:Math.floor(i/60/60%24),minutes:Math.floor(i/60%60),seconds:Math.floor(i%60)}}getTwoDigitNumber(e){return 1===String(e).length?`0${e}`:`${e}`}isDateHasCome(){return new Date(this.deadLine).getTime()<=(new Date).getTime()}setSeparator(e=null,t=""){let i="";return"name"===this.separator?i=this.getNameSeparator(e,t):"seconds"!==t&&(i=this.separator),i}getNameSeparator(e,t){return((e,t)=>1===e||e>20&&1==+String(e)[1]?t[0]:e>1&&e<5||e>21&&+String(e)[1]>1&&+String(e)[1]<5?t[1]:0===e||e>4&&e<21||e>21&&+String(e)[1]>4||0==+String(e)[1]?t[2]:void 0)(+e,{days:["день","дня","дней"],hours:["час","часа","часов"],minutes:["минута","минуты","минут"],seconds:["секунда","секунды","секунд"]}[t])}}({timerSelector:"#timer",format:{daysSelector:"#timer-days",hoursSelector:"#timer-hours",minutesSelector:"#timer-minutes",secondsSelector:"#timer-seconds"},doubleZero:!0,separator:"name"}).start(),new class{constructor({toggleClass:e="active-menu",...t}){this.toggleClass=e,this.init({...t})}init({menuBtnSelector:e=".menu",menuSelector:t="menu",closeBtnSelector:i=".close-btn"}){this.menuBtn=document.querySelector(e),this.menu=document.querySelector(t),this.closeBtn=this.menu.querySelector(i),this.setEventListener()}handleTarget(){this.menu.classList.toggle(this.toggleClass)}setEventListener(){this.menuBtn.addEventListener("click",this.handleTarget.bind(this)),this.closeBtn.addEventListener("click",this.handleTarget.bind(this)),this.menu.addEventListener("click",(e=>{const{target:t}=e;"a"===t.localName&&t.closest("li")&&this.handleTarget()}))}}({menuBtnSelector:".menu",menuSelector:"menu",closeBtnSelector:".close-btn",toggleClass:"active-menu"}),new class{constructor({buttonsClassName:e,...t}){this.buttonsClassName=e,this.animationIsOn=!1,this.init({...t})}init({triggerAreaSelector:e,modalSelector:t,closeBtnSelector:i}){this.triggerAreaSelector=document.querySelector(e),this.modal=document.querySelector(t),this.closeBtn=this.modal.querySelector(i),this.setEventListener(),this.animationInit()}setEventListener(){this.triggerAreaSelector.addEventListener("click",(e=>{const{target:t}=e;[...t.classList].includes(this.buttonsClassName)&&(this.modal.style.display="block",this.animation())})),this.modal.addEventListener("click",(e=>{const{target:t}=e;t===this.closeBtn&&(this.modal.style.display="none",this.animationInit())}))}getModalSomeStyle(){let{top:e,opacity:t}=getComputedStyle(this.modal);return e=+e.replace("px",""),t=+t,{top:e,opacity:t}}animationInit(){window.innerWidth>768?(this.animationIsOn=!0,this.modal.style.opacity=0):(this.animationIsOn=!1,this.modal.style.opacity=1)}animation(){if(this.animationIsOn){this.madalOpenAnimation=requestAnimationFrame(this.animation.bind(this));let{opacity:e}=this.getModalSomeStyle();this.modal.style.opacity=e+.03<1?`${e+.03}`:"1","1"===this.modal.style.opacity&&cancelAnimationFrame(this.madalOpenAnimation)}}}({buttonsClassName:"popup-btn",triggerAreaSelector:"#service-block",modalSelector:".popup",closeBtnSelector:".popup-close"}),new class{constructor(){this.setEventListener(),console.log("va")}setEventListener(){document.addEventListener("input",(e=>{this.validation(e)})),document.addEventListener("blur",(e=>{console.log(e),this.validation(e)}),!0)}calcValidation(e){e.value=e.value.replace(/[^\d]/g,"")}formFieldsValidation(e,t){const{name:i,value:s,type:a}=e;"text"===a||"user_message"===i?"blur"===t?e.value=this.blurValidation(s):"input"===t&&(e.value=this.inputValidation(s)):"email"===a?e.value=s.replace(/[^a-z0-9@\-_.!~*']/gi,""):"tel"===a&&(e.value=s.replace(/[^0-9()\-]/g,""))}inputValidation(e){return e.replace(/[^а-я -]/gi,"")}blurValidation(e){return e=e.replace(/[^а-я -]/gi,"").replace(/[ ]+/g," ").replace(/[-]+/g,"-").replace(/^[- ]+|[ -]+$/g,""),[...e].map(((e,t)=>0===t?e.toUpperCase():e.toLowerCase())).join("")}validation(e){const{target:t}=e,i=t.closest("#calc"),s=t.closest("form");i&&this.calcValidation(t),s&&this.formFieldsValidation(t,e.type)}},new Tabs({tabPanelSelector:"#service-block",tabPanelItemSelectors:{navSelector:".service-header",navItemSelector:".service-header-tab",tabItemSelector:".service-tab"}})})();