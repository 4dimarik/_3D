(()=>{"use strict";const t=new class{constructor({deadLine:t="2021-12-27T18:35:00",timerSelector:e,format:i={},doubleZero:s=!0,separator:a=":"}){this.timerSelector=e,this.formatSelectors=i,this.separator=a,this.deadLine=t,this.doubleZero=s,this.init()}init(){this.timer=document.querySelector(this.timerSelector),this.format={},this.timer&&Object.keys(this.formatSelectors).forEach((t=>{let e=t.replace("Selector","");this.format[e]=this.timer.querySelector(this.formatSelectors[t])}))}start(){this.isDateHasCome()?this.render({days:"0",hours:"0",minutes:"0",seconds:"0"}):(this.handle(),this.updateClock=setInterval(this.handle.bind(this),1e3))}stop(){clearInterval(this.updateClock)}render(t){Object.keys(this.format).forEach((e=>{this.format[e].textContent=this.doubleZero?this.getTwoDigitNumber(t[e]):t[e],this.format[e].nextElementSibling.textContent=this.setSeparator(t[e],e)}))}handle(){if(this.isDateHasCome())this.stop();else{let t=new Date(this.deadLine).getTime(),e=(new Date).getTime();const i=this.getTimeRemaining(t,e);this.render(i)}}getTimeRemaining(t,e){let i=(t-e)/1e3;return{days:Math.floor(i/60/60/24),hours:Math.floor(i/60/60%24),minutes:Math.floor(i/60%60),seconds:Math.floor(i%60)}}getTwoDigitNumber(t){return 1===String(t).length?`0${t}`:`${t}`}isDateHasCome(){return new Date(this.deadLine).getTime()<=(new Date).getTime()}setSeparator(t=null,e=""){let i="";return"name"===this.separator?i=this.getNameSeparator(t,e):"seconds"!==e&&(i=this.separator),i}getNameSeparator(t,e){return((t,e)=>1===t||t>20&&1==+String(t)[1]?e[0]:t>1&&t<5||t>21&&+String(t)[1]>1&&+String(t)[1]<5?e[1]:0===t||t>4&&t<21||t>21&&+String(t)[1]>4||0==+String(t)[1]?e[2]:void 0)(+t,{days:["день","дня","дней"],hours:["час","часа","часов"],minutes:["минута","минуты","минут"],seconds:["секунда","секунды","секунд"]}[e])}}({timerSelector:"#timer",format:{daysSelector:"#timer-days",hoursSelector:"#timer-hours",minutesSelector:"#timer-minutes",secondsSelector:"#timer-seconds"},doubleZero:!0,separator:"name"});new class{constructor({toggleClass:t="active-menu",...e}){this.toggleClass=t,this.init({...e})}init({menuBtnSelector:t=".menu",menuSelector:e="menu",closeBtnSelector:i=".close-btn"}){this.menuBtn=document.querySelector(t),this.menu=document.querySelector(e),this.closeBtn=this.menu.querySelector(i),this.setEventListener()}handleTarget(){this.menu.classList.toggle(this.toggleClass)}setEventListener(){this.menuBtn.addEventListener("click",this.handleTarget.bind(this)),this.closeBtn.addEventListener("click",this.handleTarget.bind(this)),this.menu.addEventListener("click",(t=>{const{target:e}=t;"a"===e.localName&&e.closest("li")&&this.handleTarget()}))}}({menuBtnSelector:".menu",menuSelector:"menu",closeBtnSelector:".close-btn",toggleClass:"active-menu"}),new class{constructor({buttonsClassName:t,...e}){this.buttonsClassName=t,this.animationIsOn=!1,this.init({...e})}init({triggerAreaSelector:t,modalSelector:e,closeBtnSelector:i}){this.triggerAreaSelector=document.querySelector(t),this.modal=document.querySelector(e),this.closeBtn=this.modal.querySelector(i),this.setEventListener(),this.animationInit()}setEventListener(){this.triggerAreaSelector.addEventListener("click",(t=>{const{target:e}=t;[...e.classList].includes(this.buttonsClassName)&&(this.modal.style.display="block",this.animation())})),this.modal.addEventListener("click",(t=>{const{target:e}=t;e===this.closeBtn&&(this.modal.style.display="none",this.animationInit())}))}getModalSomeStyle(){let{top:t,opacity:e}=getComputedStyle(this.modal);return t=+t.replace("px",""),e=+e,{top:t,opacity:e}}animationInit(){window.innerWidth>768?(this.animationIsOn=!0,this.modal.style.opacity=0):(this.animationIsOn=!1,this.modal.style.opacity=1)}animation(){if(this.animationIsOn){this.madalOpenAnimation=requestAnimationFrame(this.animation.bind(this));let{opacity:t}=this.getModalSomeStyle();this.modal.style.opacity=t+.03<1?`${t+.03}`:"1","1"===this.modal.style.opacity&&cancelAnimationFrame(this.madalOpenAnimation)}}}({buttonsClassName:"popup-btn",triggerAreaSelector:"#service-block",modalSelector:".popup",closeBtnSelector:".popup-close"}),t.start(),new class{constructor(){this.setEventListener(),console.log("va")}setEventListener(){document.addEventListener("input",(t=>{this.validation(t)})),document.addEventListener("blur",(t=>{console.log(t),this.validation(t)}),!0)}calcValidation(t){t.value=t.value.replace(/[^\d]/g,"")}formFieldsValidation(t,e){const{name:i,value:s,type:a}=t;"text"===a||"user_message"===i?"blur"===e?t.value=this.blurValidation(s):"input"===e&&(t.value=this.inputValidation(s)):"email"===a?t.value=s.replace(/[^a-z0-9@\-_.!~*']/gi,""):"tel"===a&&(t.value=s.replace(/[^0-9()\-]/g,""))}inputValidation(t){return t.replace(/[^а-я -]/gi,"")}blurValidation(t){return t=t.replace(/[^а-я -]/gi,"").replace(/[ ]+/g," ").replace(/[-]+/g,"-").replace(/^[- ]+|[ -]+$/g,""),[...t].map(((t,e)=>0===e?t.toUpperCase():t.toLowerCase())).join("")}validation(t){const{target:e}=t,i=e.closest("#calc"),s=e.closest("form");i&&this.calcValidation(e),s&&this.formFieldsValidation(e,t.type)}}})();